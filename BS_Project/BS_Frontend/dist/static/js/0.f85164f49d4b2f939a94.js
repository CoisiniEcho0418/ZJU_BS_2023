webpackJsonp([0],{"5zde":function(e,t,a){a("zQR9"),a("qyJz"),e.exports=a("FeBl").Array.from},"c/Tr":function(e,t,a){e.exports={default:a("5zde"),__esModule:!0}},cSfM:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("c/Tr"),n=a.n(s),r=a("Xxa5"),o=a.n(r),i=a("exGp"),c=a.n(i),l=a("Dd8w"),u=a.n(l),d=a("NYxO"),h=a("8/0w"),v={components:{},props:{},data:function(){return{}},watch:{},computed:u()({},Object(d.c)("devices",["getUserDevices"]),Object(d.c)("message",["getTotalMessageCount"]),{totalDevices:function(){var e=this.getUserDevices.length;return console.log(e),void 0!==e&&null!==e?e:0},totalMessages:function(){var e=this.getTotalMessageCount;return console.log(e),void 0!==e&&null!==e?e:0},activeDevices:function(){var e=this.getUserDevices.filter(function(e){return e.isActive}).length;return console.log(e),void 0!==e&&null!==e?e:0}}),methods:u()({},Object(d.b)("devices",["fetchUserDevices"]),Object(d.b)("message",["fetchTotalMessageCount","fetchRecentlyMessageCount"]),{showFirstEcharts:function(){var e=this;return c()(o.a.mark(function t(){var a,s,n,r,i,c,l,u,d,v,f,g,p;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=function(e){return e.getFullYear()+"-"+(e.getMonth()+1).toString().padStart(2,"0")+"-"+e.getDate().toString().padStart(2,"0")+" "+e.getHours().toString().padStart(2,"0")+":"+e.getMinutes().toString().padStart(2,"0")+":"+e.getSeconds().toString().padStart(2,"0")},a=e.getRecentSevenDaysFormatted(),console.log(a),n=new Date,r=s(n),console.log("today",r),t.next=8,h.a.get("/device/new-devices-count",{params:{user_id:e.$store.state.userId,today:r}});case 8:i=t.sent,console.log("first table data:",i),c=i.data.data||[],l=c.map(function(e){return e.date}),u=c.map(function(e){return e.count}),d=e.getRecentSevenDays(),v=d.map(function(e){var t=l.indexOf(e);return-1!==t?u[t]:0}),f=document.getElementById("first-chart"),g=e.$echarts.init(f),p={title:{text:"最近七天新增设备数"},tooltip:{trigger:"axis"},legend:{data:["Number of New Devices in the Last Seven Days"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{show:!0,orient:"vertical",left:"right",feature:{saveAsImage:{show:!0},dataView:{show:!0,readOnly:!1}}},xAxis:{type:"category",boundaryGap:!1,data:a},yAxis:{type:"value"},series:[{name:"Number of New Devices in the Last Seven Days.",type:"line",stack:"Total",data:v}]},g.setOption(p);case 19:case"end":return t.stop()}},t,e)}))()},showSecondEcharts:function(){var e=this,t=this.$store.getters["devices/getDeviceCountList"];if(t.length>0){var a,s=document.getElementById("second-chart"),n=this.$echarts.init(s);a={title:{text:"设备类型分布图"},tooltip:{trigger:"item"},legend:{bottom:"-3%",left:"center",width:"60%"},toolbox:{show:!0,orient:"vertical",left:"right",feature:{saveAsImage:{show:!0},dataView:{show:!0,readOnly:!1}}},series:[{name:"该类型设备总数",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:40,fontWeight:"bold"}},labelLine:{show:!1},data:t.map(function(t,a){return{value:t,name:e.mapDeviceType(a+1)}})}]},n.setOption(a)}},showThirdEcharts:function(){var e=this.getRecentSevenDaysFormatted();console.log("recentSevenDaysFormatted",e);var t=this.$store.getters["message/getNormalCount"],a=this.$store.getters["message/getAbnormalCount"];if(t.length>0&&a.length>0){var s,n=document.getElementById("third-chart"),r={show:!0,position:"insideBottom",distance:15,align:"left",verticalAlign:"middle",rotate:90,formatter:"{c}  {name|{a}}",fontSize:16,rich:{name:{}}};s={title:{text:"最近七天消息图"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{bottom:"0%",left:"center",data:["正常","异常"]},toolbox:{show:!0,orient:"vertical",left:"right",top:"center",feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar","stack"]},restore:{show:!0},saveAsImage:{show:!0}}},xAxis:[{type:"category",axisTick:{show:!1},data:e}],yAxis:[{type:"value"}],series:[{name:"正常",type:"bar",barGap:0,label:r,emphasis:{focus:"series"},color:"#66b1ff",data:t},{name:"异常",type:"bar",label:r,emphasis:{focus:"series"},color:"#ee360d",data:a}]},this.$echarts.init(n).setOption(s)}},getRecentSevenDays:function(){for(var e=[],t=6;t>=0;t--){var a=new Date;a.setDate(a.getDate()-t);var s=a.getFullYear()+"-"+(a.getMonth()+1).toString().padStart(2,"0")+"-"+a.getDate().toString().padStart(2,"0");e.push(s)}return console.log("RecentSevenDays",e),e},getRecentSevenDaysFormatted:function(){var e=new Date;return n()({length:7},function(t,a){var s=new Date(e);return s.setDate(e.getDate()-a),s.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit"})}).reverse()},mapDeviceType:function(e){switch(e){case 1:return"智能家居";case 2:return"生命安全设备";case 3:return"车载设备";case 4:return"可穿戴设备";case 5:return"工业智能网关";case 6:return"其他";default:return"未知"}}}),created:function(){this.fetchUserDevices(),this.fetchTotalMessageCount(),this.fetchRecentlyMessageCount()},mounted:function(){var e=this;this.$nextTick(c()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.fetchUserDevices();case 2:return t.next=4,e.fetchTotalMessageCount();case 4:return t.next=6,e.fetchRecentlyMessageCount();case 6:e.showFirstEcharts(),e.showSecondEcharts(),e.showThirdEcharts();case 9:case"end":return t.stop()}},t,e)})))}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"overview"},[a("div",{staticClass:"first_row"},[a("div",{staticClass:"block1"},[a("el-card",{staticClass:"info"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-bangzhu",circle:""}}),e._v(" "),a("h2",{staticClass:"num-info"},[e._v(e._s(e.totalDevices))]),e._v(" "),a("p",{staticClass:"desc"},[e._v("总设备数")])],1),e._v(" "),a("el-card",{staticClass:"info"},[a("el-button",{attrs:{type:"success",icon:"el-icon-connection",circle:""}}),e._v(" "),a("h2",{staticClass:"num-info"},[e._v(e._s(e.activeDevices))]),e._v(" "),a("p",{staticClass:"desc"},[e._v("活跃设备数")])],1),e._v(" "),a("el-card",{staticClass:"info"},[a("el-button",{attrs:{type:"danger",icon:"el-icon-message",circle:""}}),e._v(" "),a("h2",{staticClass:"num-info"},[e._v(e._s(e.totalMessages))]),e._v(" "),a("p",{staticClass:"desc"},[e._v("总消息数")])],1)],1),e._v(" "),a("div",{staticClass:"block2",attrs:{id:"first-chart"}})]),e._v(" "),e._m(0)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"second_row"},[t("div",{staticClass:"block3",attrs:{id:"second-chart"}}),this._v(" "),t("div",{staticClass:"block4",attrs:{id:"third-chart"}})])}]};var g=a("VU/8")(v,f,!1,function(e){a("m1p2")},"data-v-4ca8528f",null);t.default=g.exports},fBQ2:function(e,t,a){"use strict";var s=a("evD5"),n=a("X8DO");e.exports=function(e,t,a){t in e?s.f(e,t,n(0,a)):e[t]=a}},m1p2:function(e,t){},qyJz:function(e,t,a){"use strict";var s=a("+ZMJ"),n=a("kM2E"),r=a("sB3e"),o=a("msXi"),i=a("Mhyx"),c=a("QRG4"),l=a("fBQ2"),u=a("3fs2");n(n.S+n.F*!a("dY0y")(function(e){Array.from(e)}),"Array",{from:function(e){var t,a,n,d,h=r(e),v="function"==typeof this?this:Array,f=arguments.length,g=f>1?arguments[1]:void 0,p=void 0!==g,m=0,y=u(h);if(p&&(g=s(g,f>2?arguments[2]:void 0,2)),void 0==y||v==Array&&i(y))for(a=new v(t=c(h.length));t>m;m++)l(a,m,p?g(h[m],m):h[m]);else for(d=y.call(h),a=new v;!(n=d.next()).done;m++)l(a,m,p?o(d,g,[n.value,m],!0):n.value);return a.length=m,a}})}});
//# sourceMappingURL=0.f85164f49d4b2f939a94.js.map