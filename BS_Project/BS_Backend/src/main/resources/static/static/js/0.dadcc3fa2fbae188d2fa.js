webpackJsonp([0],{"5zde":function(e,t,s){s("zQR9"),s("qyJz"),e.exports=s("FeBl").Array.from},O40M:function(e,t){},"c/Tr":function(e,t,s){e.exports={default:s("5zde"),__esModule:!0}},cSfM:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("c/Tr"),n=s.n(a),r=s("Xxa5"),o=s.n(r),i=s("exGp"),c=s.n(i),l=s("Dd8w"),u=s.n(l),d=s("NYxO"),h=s("8/0w"),v={components:{},props:{},data:function(){return{}},watch:{},computed:u()({},Object(d.c)("devices",["getUserDevices"]),Object(d.c)("message",["getTotalMessageCount"]),{totalDevices:function(){var e=this.getUserDevices.length;return console.log(e),void 0!==e&&null!==e?e:0},totalMessages:function(){var e=this.getTotalMessageCount;return console.log(e),void 0!==e&&null!==e?e:0},activeDevices:function(){var e=this.getUserDevices.filter(function(e){return e.isActive}).length;return console.log(e),void 0!==e&&null!==e?e:0}}),methods:u()({},Object(d.b)("devices",["fetchUserDevices"]),Object(d.b)("message",["fetchTotalMessageCount","fetchRecentlyMessageCount"]),{showFirstEcharts:function(){var e=this;return c()(o.a.mark(function t(){var s,a,n,r,i,c,l,u,d,v,f,g,m,p,y;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=e.getRecentSevenDaysFormatted(),console.log(s),(a=new Date).setDate(a.getDate()),n=a.getFullYear(),r=(a.getMonth()+1).toString().padStart(2,"0"),i=a.getDate().toString().padStart(2,"0"),c=n+"-"+r+"-"+i,console.log("today",c),t.next=11,h.a.get("/device/new-devices-count",{params:{user_id:e.$store.state.userId,today:c}});case 11:l=t.sent,console.log("first table data:",l),u=l.data.data||[],d=u.map(function(e){return e.date}),v=u.map(function(e){return e.count}),f=e.getRecentSevenDays(),g=f.map(function(e){var t=d.indexOf(e);return-1!==t?v[t]:0}),m=document.getElementById("first-chart"),p=e.$echarts.init(m),y={title:{text:"最近七天新增设备数"},tooltip:{trigger:"axis"},legend:{data:["Number of New Devices in the Last Seven Days"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{show:!0,orient:"vertical",left:"right",feature:{saveAsImage:{show:!0},dataView:{show:!0,readOnly:!1}}},xAxis:{type:"category",boundaryGap:!1,data:s},yAxis:{type:"value"},series:[{name:"Number of New Devices in the Last Seven Days.",type:"line",stack:"Total",data:g}]},p.setOption(y);case 22:case"end":return t.stop()}},t,e)}))()},showSecondEcharts:function(){var e=this,t=this.$store.getters["devices/getDeviceCountList"];if(t.length>0){var s,a=document.getElementById("second-chart"),n=this.$echarts.init(a);s={title:{text:"设备类型分布图"},tooltip:{trigger:"item"},legend:{bottom:"-3%",left:"center",width:"60%"},toolbox:{show:!0,orient:"vertical",left:"right",feature:{saveAsImage:{show:!0},dataView:{show:!0,readOnly:!1}}},series:[{name:"该类型设备总数",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:40,fontWeight:"bold"}},labelLine:{show:!1},data:t.map(function(t,s){return{value:t,name:e.mapDeviceType(s+1)}})}]},n.setOption(s)}},showThirdEcharts:function(){var e=this.getRecentSevenDaysFormatted();console.log("recentSevenDaysFormatted",e);var t=this.$store.getters["message/getNormalCount"],s=this.$store.getters["message/getAbnormalCount"];if(t.length>0&&s.length>0){var a,n=document.getElementById("third-chart"),r={show:!0,position:"insideBottom",distance:15,align:"left",verticalAlign:"middle",rotate:90,formatter:"{c}  {name|{a}}",fontSize:16,rich:{name:{}}};a={title:{text:"最近七天消息图"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{bottom:"0%",left:"center",data:["正常","异常"]},toolbox:{show:!0,orient:"vertical",left:"right",top:"center",feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar","stack"]},restore:{show:!0},saveAsImage:{show:!0}}},xAxis:[{type:"category",axisTick:{show:!1},data:e}],yAxis:[{type:"value"}],series:[{name:"正常",type:"bar",barGap:0,label:r,emphasis:{focus:"series"},color:"#66b1ff",data:t},{name:"异常",type:"bar",label:r,emphasis:{focus:"series"},color:"#ee360d",data:s}]},this.$echarts.init(n).setOption(a)}},getRecentSevenDays:function(){for(var e=[],t=6;t>=0;t--){var s=new Date;s.setDate(s.getDate()-t);var a=s.getFullYear()+"-"+(s.getMonth()+1).toString().padStart(2,"0")+"-"+s.getDate().toString().padStart(2,"0");e.push(a)}return console.log("RecentSevenDays",e),e},getRecentSevenDaysFormatted:function(){var e=new Date;return n()({length:7},function(t,s){var a=new Date(e);return a.setDate(e.getDate()-s),a.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit"})}).reverse()},mapDeviceType:function(e){switch(e){case 1:return"智能家居";case 2:return"生命安全设备";case 3:return"车载设备";case 4:return"可穿戴设备";case 5:return"工业智能网关";case 6:return"其他";default:return"未知"}}}),created:function(){this.fetchUserDevices(),this.fetchTotalMessageCount(),this.fetchRecentlyMessageCount()},mounted:function(){var e=this;this.$nextTick(c()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.fetchUserDevices();case 2:return t.next=4,e.fetchTotalMessageCount();case 4:return t.next=6,e.fetchRecentlyMessageCount();case 6:e.showFirstEcharts(),e.showSecondEcharts(),e.showThirdEcharts();case 9:case"end":return t.stop()}},t,e)})))}},f={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"overview"},[s("div",{staticClass:"first_row"},[s("div",{staticClass:"block1"},[s("el-card",{staticClass:"info"},[s("el-button",{attrs:{type:"primary",icon:"el-icon-bangzhu",circle:""}}),e._v(" "),s("h2",{staticClass:"num-info"},[e._v(e._s(e.totalDevices))]),e._v(" "),s("p",{staticClass:"desc"},[e._v("总设备数")])],1),e._v(" "),s("el-card",{staticClass:"info"},[s("el-button",{attrs:{type:"success",icon:"el-icon-connection",circle:""}}),e._v(" "),s("h2",{staticClass:"num-info"},[e._v(e._s(e.activeDevices))]),e._v(" "),s("p",{staticClass:"desc"},[e._v("活跃设备数")])],1),e._v(" "),s("el-card",{staticClass:"info"},[s("el-button",{attrs:{type:"danger",icon:"el-icon-message",circle:""}}),e._v(" "),s("h2",{staticClass:"num-info"},[e._v(e._s(e.totalMessages))]),e._v(" "),s("p",{staticClass:"desc"},[e._v("总消息数")])],1)],1),e._v(" "),s("div",{staticClass:"block2",attrs:{id:"first-chart"}})]),e._v(" "),e._m(0)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"second_row"},[t("div",{staticClass:"block3",attrs:{id:"second-chart"}}),this._v(" "),t("div",{staticClass:"block4",attrs:{id:"third-chart"}})])}]};var g=s("VU/8")(v,f,!1,function(e){s("O40M")},"data-v-0c84df90",null);t.default=g.exports},fBQ2:function(e,t,s){"use strict";var a=s("evD5"),n=s("X8DO");e.exports=function(e,t,s){t in e?a.f(e,t,n(0,s)):e[t]=s}},qyJz:function(e,t,s){"use strict";var a=s("+ZMJ"),n=s("kM2E"),r=s("sB3e"),o=s("msXi"),i=s("Mhyx"),c=s("QRG4"),l=s("fBQ2"),u=s("3fs2");n(n.S+n.F*!s("dY0y")(function(e){Array.from(e)}),"Array",{from:function(e){var t,s,n,d,h=r(e),v="function"==typeof this?this:Array,f=arguments.length,g=f>1?arguments[1]:void 0,m=void 0!==g,p=0,y=u(h);if(m&&(g=a(g,f>2?arguments[2]:void 0,2)),void 0==y||v==Array&&i(y))for(s=new v(t=c(h.length));t>p;p++)l(s,p,m?g(h[p],p):h[p]);else for(d=y.call(h),s=new v;!(n=d.next()).done;p++)l(s,p,m?o(d,g,[n.value,p],!0):n.value);return s.length=p,s}})}});
//# sourceMappingURL=0.dadcc3fa2fbae188d2fa.js.map